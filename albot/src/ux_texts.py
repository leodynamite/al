"""
UX texts and messaging for AL Bot
"""
from typing import Dict, Any
from .branding import BrandingManager
from .billing import BillingManager, SubscriptionTier


class UXTexts:
    """UX texts and messaging system"""
    
    def __init__(self, branding_manager: BrandingManager, billing_manager: BillingManager):
        self._branding = branding_manager
        self._billing = billing_manager
    
    async def get_welcome_message(self, user_id: int) -> str:
        """Get personalized welcome message"""
        subscription = await self._billing.get_user_subscription(user_id)
        branding = self._branding.get_bot_branding(subscription)
        
        if subscription and subscription.tier == SubscriptionTier.TRIAL:
            return f"""–ü—Ä–∏–≤–µ—Ç! –Ø {branding.bot_name} ‚Äî –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –ª–∏–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

–í –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ —è —Ä–∞–±–æ—Ç–∞—é –ø–æ–¥ —Å–≤–æ–∏–º –±—Ä–µ–Ω–¥–æ–º.
–í –ø–ª–∞—Ç–Ω–æ–π ‚Äî –∫–ª–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç –≤–∏–¥–µ—Ç—å –∏–º–µ–Ω–Ω–æ –≤–∞—à–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ.

–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"""
        else:
            return f"""–ü—Ä–∏–≤–µ—Ç! –Ø {branding.bot_name} ‚Äî –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ –ª–∏–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

–ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –∏ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ª–∏–¥–æ–≤.
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:"""
    
    def get_file_upload_status(self) -> str:
        """File upload status message"""
        return "–§–∞–π–ª –ø—Ä–∏–Ω—è—Ç, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é‚Ä¶"
    
    def get_analysis_progress(self, eta_seconds: int = 20) -> str:
        """Analysis progress message"""
        return f"–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –¥–∞–Ω–Ω—ã–µ‚Ä¶ ETA: ~{eta_seconds} —Å–µ–∫"
    
    def get_script_ready_message(self) -> str:
        """Script generation complete message"""
        return """–°–∫—Ä–∏–ø—Ç –≥–æ—Ç–æ–≤! 

–•–æ—Ç–∏—Ç–µ:
‚Ä¢ –ü—Ä–∏–º–µ–Ω–∏—Ç—å ‚Äî –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç
‚Ä¢ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äî –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–æ–ø—Ä–æ—Å—ã
‚Ä¢ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –¥–µ–º–æ-–ª–∏–¥–∞—Ö"""
    
    def get_hot_lead_notification(self, lead_data: Dict[str, Any]) -> str:
        """Hot lead push notification"""
        name = lead_data.get('name', '–ö–ª–∏–µ–Ω—Ç')
        city = lead_data.get('city', '–ì–æ—Ä–æ–¥')
        budget = lead_data.get('budget', '–ë—é–¥–∂–µ—Ç')
        
        return f"""üî• HOT –ª–∏–¥: {name}, {city}, –±—é–¥–∂–µ—Ç {budget}

–°—Ä–æ—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å!"""
    
    def get_trial_expired_message(self) -> str:
        """Trial expired message"""
        return """‚ùå –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è

–î–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É:
‚Ä¢ Basic: 9 900 ‚ÇΩ/–º–µ—Å (–¥–æ 100 –¥–∏–∞–ª–æ–≥–æ–≤)
‚Ä¢ Pro: 19 900 ‚ÇΩ/–º–µ—Å (–¥–æ 300 –¥–∏–∞–ª–æ–≥–æ–≤) 
‚Ä¢ Enterprise: 39 900 ‚ÇΩ/–º–µ—Å (–±–µ–∑–ª–∏–º–∏—Ç)

–û–∫—É–ø–∞–µ—Ç—Å—è —Å –æ–¥–Ω–æ–π —Å–¥–µ–ª–∫–∏! üí∞"""
    
    def get_read_only_mode_message(self) -> str:
        """Read-only mode message"""
        return """üìñ –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

–ò—Å—Ç–æ—Ä–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞, –Ω–æ –Ω–æ–≤—ã–µ –ª–∏–¥—ã –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è.
–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã."""
    
    def get_subscription_benefits(self, tier: SubscriptionTier) -> str:
        """Subscription benefits message"""
        benefits = {
            SubscriptionTier.BASIC: """‚úÖ Basic (9 900 ‚ÇΩ/–º–µ—Å):
‚Ä¢ –î–æ 100 –¥–∏–∞–ª–æ–≥–æ–≤ –≤ –º–µ—Å—è—Ü
‚Ä¢ –ë–∞–∑–æ–≤—ã–π –±—Ä–µ–Ω–¥–∏–Ω–≥
‚Ä¢ Email –ø–æ–¥–¥–µ—Ä–∂–∫–∞""",
            
            SubscriptionTier.PRO: """‚úÖ Pro (19 900 ‚ÇΩ/–º–µ—Å):
‚Ä¢ –î–æ 300 –¥–∏–∞–ª–æ–≥–æ–≤ –≤ –º–µ—Å—è—Ü
‚Ä¢ –ü–æ–ª–Ω—ã–π –±—Ä–µ–Ω–¥–∏–Ω–≥ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞
‚Ä¢ CRM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚Ä¢ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞""",
            
            SubscriptionTier.ENTERPRISE: """‚úÖ Enterprise (39 900 ‚ÇΩ/–º–µ—Å):
‚Ä¢ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏
‚Ä¢ –ö–∞—Å—Ç–æ–º–Ω—ã–π –±–æ—Ç
‚Ä¢ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
‚Ä¢ API –¥–æ—Å—Ç—É–ø"""
        }
        
        return benefits.get(tier, "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞")
    
    def get_commercial_offer(self) -> str:
        """Commercial offer message"""
        return """üíº –ö–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ

üéØ AL Bot = –≤–∞—à –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7

‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏–¥–æ–≤
‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ
‚Ä¢ –ù–µ —É—Å—Ç–∞–µ—Ç –∏ –Ω–µ –±–æ–ª–µ–µ—Ç
‚Ä¢ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

üí∞ –û–∫—É–ø–∞–µ—Ç—Å—è —Å –æ–¥–Ω–æ–π —Å–¥–µ–ª–∫–∏ ‚Üí –æ—Ç 9 900 ‚ÇΩ/–º–µ—Å

üöÄ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–µ—Å—Ç 14 –¥–Ω–µ–π ‚Äî –Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ø–æ–¥–ø–∏—Å–∫–µ –∫–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –∏–º–µ–Ω–Ω–æ –≤–∞—à–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ."""
    
    def get_branding_explanation(self) -> str:
        """Branding explanation message"""
        return """üé® –ë—Ä–µ–Ω–¥–∏–Ω–≥ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞

–í –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏:
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç "AL Bot"
‚Ä¢ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω
‚Ä¢ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è

–í –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏:
‚Ä¢ –ö–ª–∏–µ–Ω—Ç—ã –≤–∏–¥—è—Ç –≤–∞—à–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ
‚Ä¢ –í–∞—à –ª–æ–≥–æ—Ç–∏–ø –∏ —Ü–≤–µ—Ç–∞
‚Ä¢ –ü–æ–ª–Ω–∞—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è
‚Ä¢ –ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç –¥–æ–≤–µ—Ä–∏—è"""
    
    def get_success_metrics(self, metrics: Dict[str, Any]) -> str:
        """Success metrics message"""
        dialogs_today = metrics.get('dialogs_today', 0)
        hot_leads = metrics.get('hot_leads', 0)
        meetings_scheduled = metrics.get('meetings_scheduled', 0)
        conversion_rate = metrics.get('conversion_rate', 0)
        
        return f"""üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

‚Ä¢ –î–∏–∞–ª–æ–≥–æ–≤ —Å–µ–≥–æ–¥–Ω—è: {dialogs_today}
‚Ä¢ –ì–æ—Ä—è—á–∏—Ö –ª–∏–¥–æ–≤: {hot_leads}
‚Ä¢ –í—Å—Ç—Ä–µ—á –Ω–∞–∑–Ω–∞—á–µ–Ω–æ: {meetings_scheduled}
‚Ä¢ –ö–æ–Ω–≤–µ—Ä—Å–∏—è: {conversion_rate:.1f}%

–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! üöÄ"""
    
    def get_error_message(self, error_type: str) -> str:
        """Error message"""
        error_messages = {
            'file_format': "‚ùå –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: .csv, .xlsx, .pdf, .docx, .txt",
            'file_empty': "‚ùå –§–∞–π–ª –ø—É—Å—Ç–æ–π. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.",
            'file_too_large': "‚ùå –§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10 –ú–ë",
            'llm_error': "‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.",
            'subscription_error': "‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.",
            'network_error': "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É."
        }
        
        return error_messages.get(error_type, "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.")
    
    def get_help_message(self) -> str:
        """Help message"""
        return """üÜò –ü–æ–º–æ—â—å

üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
‚Ä¢ /start ‚Äî –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚Ä¢ /metrics ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚Ä¢ /leads ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–∏–¥–æ–≤
‚Ä¢ /settings ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚Ä¢ /billing ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞
‚Ä¢ /help ‚Äî —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞: @albot_support
üìß Email: support@albot.ru"""
    
    def get_onboarding_question(self, question_num: int, total: int) -> str:
        """Onboarding question message"""
        questions = [
            "1Ô∏è‚É£ –ö–∞–∫–æ–π —Ç–∏–ø –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏?",
            "2Ô∏è‚É£ –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –≤–∞—à–∏—Ö —Å–¥–µ–ª–æ–∫?",
            "3Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω–æ–π –∫–∞–Ω–∞–ª –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è?",
            "4Ô∏è‚É£ –¶–µ–ª—å —Å–∫—Ä–∏–ø—Ç–∞?",
            "5Ô∏è‚É£ –°—Ä–æ—á–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤?",
            "6Ô∏è‚É£ –†–µ–≥–∏–æ–Ω —Ä–∞–±–æ—Ç—ã?",
            "7Ô∏è‚É£ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤?",
            "8Ô∏è‚É£ –ò—Å—Ö–æ–¥—è—â–∏–µ –¥–∏–∞–ª–æ–≥–∏?"
        ]
        
        if question_num <= len(questions):
            return f"{questions[question_num-1]} ({question_num}/{total})"
        return f"–í–æ–ø—Ä–æ—Å {question_num} –∏–∑ {total}"
    
    def get_legal_notice(self) -> str:
        """Legal notice for outbound bot"""
        return """‚ö†Ô∏è –ü—Ä–∞–≤–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

–ò—Å—Ö–æ–¥—è—â–∏–µ –¥–∏–∞–ª–æ–≥–∏ –º–æ–≥—É—Ç —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–∞–∫–æ–Ω–æ–º –æ —Ä–µ–∫–ª–∞–º–µ –∏ –∑–∞—â–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

‚úÖ –Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å–ª–æ–≤–∏—è–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚ùå –û—Ç–∫–∞–∑–∞—Ç—å—Å—è –æ—Ç –∏—Å—Ö–æ–¥—è—â–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤

–ê–≥–µ–Ω—Ç—Å—Ç–≤–æ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ–±–ª—é–¥–µ–Ω–∏–µ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞."""

